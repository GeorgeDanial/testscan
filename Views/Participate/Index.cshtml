@model IEnumerable<Models.Participate>
@using Portal.Helpers
@{
    ViewBag.Title = "Participants";
}

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-sm-4">
        <h2>Index</h2>
        <ol class="breadcrumb">
            <li class="active">
                <strong>Participants</strong>
            </li>
        </ol>
    </div>
</div>




<style>
    button[data-toggle="collapse"] {
        text-align: left;
        font-size: 13px;
    }

        button[data-toggle="collapse"] i {
            margin-right: 5px;
        }

        button[data-toggle="collapse"][aria-expanded="true"] i.glyphicon-chevron-right:before {
            content: "\e114";
        }
</style>

<div class="wrapper wrapper-content animated fadeInRight">
    <div class="row" id="ParticipateList">
        <div class="col-lg-12" data-bind="with: Grid">
            <div class="ibox ">



                <div class="card">
                    <button class="btn btn-link card-header" style="padding-right :15px" data-toggle="collapse" data-target="#collapseThree" aria-expanded="true" aria-controls="collapseThree">
                        <i class="glyphicon glyphicon-chevron-right"></i>Search
                    </button>
                    <div id="collapseThree" class="collapse show" aria-labelledby="headingThree" data-parent="#accordion">
                        <div class="card-body">
                            <form data-bind="submit: Search" @*class="ibox-heading"*@>
                                <div class="row">
                                    <div class="col-lg-12">

                                        <div class="form-group col-lg-6">
                                            <label class="">Search By</label>
                                            <select class="form-control text-box" data-bind="value: SearchBy, options: $root.SearchList, optionsText: 'optionsText', optionsValue: 'value'"></select>
                                        </div>

                                        <div class="form-group col-lg-6" data-bind="visible: SearchBy() == '_Email'">
                                            <label class="">For</label>
                                            <input type="text" class="form-control text-box single-line" data-bind="value: SC._Email" />
                                        </div>

                                        <div class="form-group col-lg-6" data-bind="visible: SearchBy() == '_Name'">
                                            <label class="">For</label>
                                            <input type="text" class="form-control text-box single-line" data-bind="value: SC._Name" />
                                        </div>
                                    </div>
                                    @*<div class="form-group col-lg-6">
                                            <label class="">Email</label>
                                            <input type="text" class="form-control text-box single-line" data-bind="value: SC._Email" />
                                        </div>

                                        <div class="form-group col-lg-6">
                                            <label class="">Name</label>
                                            <input type="text" class="form-control text-box single-line" data-bind="value: SC._Name" />
                                        </div>

                                        <div class="form-group col-lg-6">
                                            <label class="">Rows Per Page</label>
                                            <select class="form-control text-box" data-bind="value: SC.RowsPerPage">
                                                <option value="10">10</option>
                                                <option value="15">15</option>
                                                <option value="20">20</option>
                                                <option value="25">25</option>
                                                <option value="50">50</option>
                                            </select>
                                        </div>*@

                                </div>

                                <div class="row pull-right" style="padding-right :40px ; padding-bottom:20px;">
                                    <input type="submit" value="Search" class="btn btn-primary fa fa-search">
                                </div>

                            </form>
                        </div>
                    </div>
                </div>

                <div class="ibox-content">

                    <div id="webGrid_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4 no-footer">

                        @Html.Partial("_KoGrid")
                    </div>

                </div>

            </div>
        </div>
    </div>
</div>

<template id="Id">
    <a class="" target="_blank" href="#" data-bind="text: Id, attr: { href: '@Url.Action("View", "Participate")/' + Id }"></a>
</template>
<template id="Name">
    <a class="" target="_blank" href="#" data-bind="text: Name, attr: { href: '@Url.Action("View", "Participate")/' + Id }"></a>
</template>
<template id="Email">
    <a class="" target="_blank" href="#" data-bind="text: Email, attr: { href: '@Url.Action("View", "Participate")/' + Id }"></a>
</template>
@section Scripts {
    @*@Scripts.Render("~/plugins/dataTables")*@
    <script src="~/Scripts/knockout-3.3.0.js"></script>
    <script src="~/Scripts/knockout.viewmodel.2.0.3.js"></script>
    <script src="~/Scripts/sugar.js"></script>
    <script src="~/Scripts/koCustom.js"></script>

    <script type="text/javascript">
        function Controller() {
            var self = this;
            self.SearchList = [
                { value: "Select", optionsText: 'Select' },
                { value: "_Email", optionsText: 'Email' },
                { value: "_Name", optionsText: 'Name' },


            ];
            self.Grid = new KoGrid("@Url.Action("Search")", @Html.Raw(Json.Encode(new Portal.UISC.ParticipateSC() { SortAsc = false, SortColumn = "Id", RowsPerPage = 15, })));
            self.Grid.SearchBy = ko.observable("Select");
            self.Grid.SearchBy.subscribe(function () {
                ko.viewmodel.updateFromModel(self.Grid.SC, self.SC);
            });
            self.Grid.GridColumns.push({ Header: "ID", Name: "Id", IsSort: true, Type: "template", ViewOrder: ko.observable(0), });
            self.Grid.GridColumns.push({ Header: "Participant Email", Name: "Email", IsSort: true, Type: "template", ViewOrder: ko.observable(1), });
            self.Grid.GridColumns.push({ Header: "Participant Name", Name: "Name", IsSort: true, Type: "template", ViewOrder: ko.observable(2), });

            //self.Grid.GridColumns.push({ Header: "Controls", Name: "MettingGridControls", IsSort: false, Type: "template", ViewOrder: ko.observable(99999), });
        }

        $(document).ready(function () {
            var controller = new Controller();
            ko.applyBindings(controller, document.getElementById("ParticipateList"));
            controller.Grid.Search();
        });
    </script>
}